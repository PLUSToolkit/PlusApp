@ECHO off 
REM Hide all your directories from users

REM RETURN_CODE is 0 on success and >0 if something failed
SET RETURN_CODE=0

SET ORIGPATH=%PATH%
SET DIRCMD=0 

REM First we need to build a Release version 
"${CMAKE_MAKE_PROGRAM}" PlusApp.sln /build Release /project ALL_BUILD
IF ERRORLEVEL 1 GOTO BUILDFAILED
ECHO Release build DONE

REM Build documentation
IF ${BUILD_DOCUMENTATION}==OFF GOTO SKIP_USER_MANUAL
call CreateUserManual.bat
IF ERRORLEVEL 1 GOTO BUILDFAILED
ECHO User manual generation DONE
:SKIP_USER_MANUAL

:PACKAGE
REM Build the package 
"${CMAKE_CPACK_COMMAND}" --config ./CPackConfig.cmake
IF ERRORLEVEL 1  GOTO PACKAGINGFAILED
ECHO Packaging DONE

:SUCCESS
ECHO Package generation is successfully completed.
GOTO END

:BUILDFAILED
ECHO ERROR: Build failed...
SET RETURN_CODE=1
GOTO END 

:PACKAGINGFAILED
ECHO ERROR: Package generation failed...
SET RETURN_CODE=2
GOTO END

:END
SET PATH=%ORIGPATH%
exit /b %RETURN_CODE%
